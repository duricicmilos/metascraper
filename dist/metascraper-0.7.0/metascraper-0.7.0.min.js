/*! Metascraper v0.7.0 | (c) Metascraper | MIT license */
if("undefined"==typeof jQuery)throw new Error("Metascraper requires jQuery");var meta={projectName:"Metascraper",version:"0.7.0",options:{webApiPrefix:"http://localhost:54702/api/",UnauthRedir:"/app/login.htm",attrName:"data-value",attrMemberName:"data-member",attrArrayName:"data-array",attrTextName:"data-text",attrHrefName:"data-href",attrClickName:"data-click",attrTypeName:"data-type",attrClassName:"data-class",attrScrapeName:"data-scrape",indexName:"{{*index}}",tokenName:"{{*token}}",scrape:!0},loadTypesEnum:Object.freeze({Replace:0,BeforeBeginAppend:1,AfterBeginAppend:2,BeforeEndAppend:3,AfterEndAppend:4}),storeTypesEnum:Object.freeze({ExpiryNoExtend:1,ExpiryExtend:2,OneTimeRead:3,Forever:4,Session:5}),dataTypesEnum:Object.freeze({date:"date",time:"time",datetime:"datetime",month:"month",month1:"month1",month3:"month3",monthNum:"monthNum",monthNumPad:"monthNumPad",day:"day",day1:"day1",day2:"day2",day3:"day3",dayNum:"dayNum",dayNumPad:"dayNumPad",year:"year",year2:"year2",string:"string",number:"number",json:"json"}),send:function(e){var t=meta.options.scrape;void 0!==e.scrape&&(t=e.scrape);var a=t?this.scrape(!0):{};e.data&&this.extend(a.data,e.data);var r={contentType:"application/json",dataType:"json",data:a};this.extend(r,e),-1==r.url.indexOf("://")&&(r.url=this.options.webApiPrefix+r.url),this.tokenize(r),this.ajax(r)},receive:function(e){var t=e.success,a={contentType:"application/json",dataType:"json"};this.extend(a,e),a.success=function(e,a,r){meta.bind(e),t&&t(e,a,r)};var r=a.url.indexOf("://");(-1===r||r>7)&&(a.url=this.options.webApiPrefix+a.url),this.tokenize(a),this.ajax(a)},get:function(e){var t={method:"GET"};this.extend(t,e),this.receive(t)},post:function(e){var t={method:"POST"};this.extend(t,e),this.send(t)},put:function(e){var t={method:"PUT"};this.extend(t,e),this.send(t)},del:function(e){var t={method:"DELETE"};this.extend(t,e),this.send(t)},create:function(e){this.post(e)},read:function(e){this.get(e)},update:function(e){this.put(e)},token:function(){return window.localStorage.getItem(meta.options.tokenName)},tokenize:function(e){var t=meta.token();if(t){var a={Authorization:"Bearer "+t};e.headers||(e.headers={}),this.extend(e.headers,a)}},login:function(e){var t=e.success,a={url:"Auth/Login"};this.extend(a,e),a.success=function(e,a,r){window.localStorage.setItem(meta.options.tokenName,e.token),t&&t(e,a,r)},this.post(a)},getValue:function(e){if(e instanceof HTMLInputElement)return"checkbox"===e.type?e.checked:e.value;if(e instanceof HTMLSelectElement){if(e.multiple){for(var t=[],a=e.selectedOptions,r=0;r<a.length;r++)t.push(a[r].value);return t}return e.value}return e.innerHTML},scrape:function(e){for(var t={},a=meta.options.attrName,r=this.selectAll("["+a+"]"),n=0;n<r.length;n++)if(!(r[n]instanceof HTMLTableElement||r[n]instanceof HTMLUListElement)){if(r[n].hasAttribute(meta.options.attrScrapeName))if(0==JSON.parse(r[n].getAttribute(meta.options.attrScrapeName)))continue;t[r[n].getAttribute(a)]=meta.getValue(r[n])}return e?JSON.stringify(t):t},formatValue:function(e,t){try{if(e.hasAttribute(meta.options.attrTypeName)){var a=e.getAttribute(meta.options.attrTypeName);if(a==meta.dataTypesEnum.string);else if(a==meta.dataTypesEnum.number)t=new Number(t);else if(a==meta.dataTypesEnum.date||a==meta.dataTypesEnum.time||a==meta.dataTypesEnum.datetime||a==meta.dataTypesEnum.month||a==meta.dataTypesEnum.month1||a==meta.dataTypesEnum.month3||a==meta.dataTypesEnum.monthNum||a==meta.dataTypesEnum.monthNumPad||a==meta.dataTypesEnum.day||a==meta.dataTypesEnum.day1||a==meta.dataTypesEnum.day2||a==meta.dataTypesEnum.day3||a==meta.dataTypesEnum.dayNum||a==meta.dataTypesEnum.dayNumPad||a==meta.dataTypesEnum.year||a==meta.dataTypesEnum.year2){if(t=new Date(t),a==meta.dataTypesEnum.date)t=t.toLocaleDateString();else if(a==meta.dataTypesEnum.time)t=t.toLocaleTimeString();else if(a==meta.dataTypesEnum.datetime)t=t.toLocaleString();else if(a==meta.dataTypesEnum.month){t=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]}else if(a==meta.dataTypesEnum.month1){t=["J","F","M","A","M","J","J","A","S","O","N","D"][t.getMonth()]}else if(a==meta.dataTypesEnum.month3){t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]}else if(a==meta.dataTypesEnum.monthNum)t=t.getMonth()+1;else if(a==meta.dataTypesEnum.monthNumPad){var r=t.getMonth()+1;t=r<10?"0"+r.toString():r.toString()}else if(a==meta.dataTypesEnum.day){t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]}else if(a==meta.dataTypesEnum.day1){t=["S","M","T","W","T","F","S"][t.getDay()]}else if(a==meta.dataTypesEnum.day2){t=["Su","Mo","Tu","We","Th","Fr","Sa"][t.getDay()]}else if(a==meta.dataTypesEnum.day3){t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()]}else if(a==meta.dataTypesEnum.dayNum)t=t.getDate();else if(a==meta.dataTypesEnum.dayNumPad){var n=t.getDate();t=n<10?"0"+n.toString():n.toString()}else if(a==meta.dataTypesEnum.year)t=t.getFullYear();else if(a==meta.dataTypesEnum.year2){var o=t.getFullYear();if(o>-10&&o<10)t=o<0?"-0"+(-1*o).toString():"0"+o.toString();else if(o<100&&o>-100)t=o;else{var i=o.toString();i=o.substr(i.length-2,2),o<0&&(i="-"+i),t=parseInt(i)}}}else a==meta.dataTypesEnum.json&&(t=JSON.stringify(t))}}catch(e){}return t},setValue:function(e,t){t=meta.formatValue(e,t),e instanceof HTMLSelectElement?e.value=t:e instanceof HTMLInputElement?"checkbox"===e.type?e.checked=t:e.value=t:e.innerHTML=t},paint:function(e,t){t=t||document;for(var a=meta.options.attrName,r=this.selectAll("["+a+"]",t),n=0;n<r.length;n++){var o=null;if(r[n].hasAttribute(meta.options.attrMemberName)){var i=r[n].getAttribute(meta.options.attrMemberName);i&&e[i]&&(o=e[i][r[n].getAttribute(a)])}else o=e[r[n].getAttribute(a)];null!=o&&meta.setValue(r[n],o)}},fill:function(e,t){var a=e.getAttribute(meta.options.attrName);if(e instanceof HTMLSelectElement){if(!a||!e.hasAttribute(meta.options.attrTextName))return;for(var r=e.getAttribute(meta.options.attrTextName),n=e.getAttribute(meta.options.attrClassName),o=0;o<t.length;o++){var i=document.createElement("option");n&&n.length>0&&i.classList.add(n),i.value=t[o][a],i.text=meta.formatValue(e,t[o][r]),e.add(i,null)}}else if(e instanceof HTMLTableElement){var s=e.tHead;if(!s||!s.rows||0==s.rows.length)return;var m=s.rows[0].cells;if(!m||0==m.length)return;for(var l=meta.getElemAttr(s.rows[0],meta.options.attrHrefName),u=meta.getElemAttr(s.rows[0],meta.options.attrClickName),d=meta.getElemAttr(s.rows[0],meta.options.attrClassName),c=0;c<t.length;c++){var p=e.insertRow(-1);if(l&&l.length>0&&u&&u.length>0)throw"ERROR reported by "+meta.projectName+". Cannot apply "+meta.options.attrHrefName+" and "+meta.options.attrClickName+" to a tr element.";if(l&&l.length>0){var f=a.length>0?l.replace(meta.options.indexName,t[c][a]):l;p.setAttribute("onclick","location.href = '"+f+"'")}if(u&&u.length>0){var h=a.length>0?u.replace(meta.options.indexName,t[c][a]):u;p.setAttribute("onclick",h)}d&&d.length>0&&p.classList.add(d);for(var y=0;y<m.length;y++){var g=p.insertCell(-1);if(m[y].hasAttribute(meta.options.attrTextName)){var T=meta.getElemAttr(m[y],meta.options.attrHrefName),N=meta.getElemAttr(m[y],meta.options.attrClickName),E=m[y].getAttribute(meta.options.attrTextName),v=meta.getElemAttr(m[y],meta.options.attrClassName);if(v&&v.length>0&&g.classList.add(v),void 0!==t[c][E]){var A=meta.formatValue(m[y],t[c][E]);if(T&&T.length>0){var b=document.createElement("a"),x=document.createTextNode(A);b.appendChild(x),N&&N.length>0&&b.setAttribute("onclick",N.replace(meta.options.indexName,t[c][a])),b.href=T.replace(meta.options.indexName,t[c][a]),g.innerHTML=b.outerHTML}else g.innerHTML=A,N&&N.length>0&&g.setAttribute("onclick",N.replace(meta.options.indexName,t[c][a]))}}}}}else if(e instanceof HTMLUListElement){var S=meta.getElemAttr(e,meta.options.attrTextName);if(!S)return;for(var M=meta.getElemAttr(e,meta.options.attrHrefName),L=meta.getElemAttr(e,meta.options.attrClickName),w=meta.getElemAttr(e,meta.options.attrClassName),H=0;H<t.length;H++){var C=document.createElement("li");w&&w.length>0&&C.classList.add(w);var k=meta.formatValue(e,t[H][S]);if(M&&M.length>0){b=document.createElement("a"),x=document.createTextNode(k);b.appendChild(x),L&&L.length>0&&b.setAttribute("onclick",L.replace(meta.options.indexName,t[H][a])),b.href=M.replace(meta.options.indexName,t[H][a]),C.appendChild(b)}else C.appendChild(document.createTextNode(k)),L&&L.length>0&&C.setAttribute("onclick",L.replace(meta.options.indexName,t[H][a]));t[H][a]&&C.setAttribute("id",t[H][a]),e.appendChild(C)}}},populate:function(e,t){t=t||document;for(var a=meta.options.attrArrayName,r=this.selectAll("["+a+"]",t),n=0;n<r.length;n++){var o=e[r[n].getAttribute(a)]?e[r[n].getAttribute(a)]:e;meta.fill(r[n],o)}},bind:function(e,t){t=t||document,meta.populate(e,t),meta.paint(e,t)},load:function(e){var t=e.success,a=e.elem,r={method:"GET",url:e.url};this.extend(r,e),r.success=function(e,n,o){r.loadType==meta.loadTypesEnum.BeforeBeginAppend?a.outerHTML=e+a.outerHTML:r.loadType==meta.loadTypesEnum.AfterBeginAppend?a.innerHTML=e+a.innerHTML:r.loadType==meta.loadTypesEnum.BeforeEndAppend?a.innerHTML=a.innerHTML+e:r.loadType==meta.loadTypesEnum.AfterEndAppend?a.innerHTML=a.outerHTML+e:a.innerHTML=e,t&&t(e,n,o)},this.ajax(r)},loadHeader:function(e){var t={elem:document.body,loadType:meta.loadTypesEnum.AfterBeginAppend};this.extend(t,e),this.load(t)},loadFooter:function(e){var t={elem:document.body,loadType:meta.loadTypesEnum.BeforeEndAppend};this.extend(t,e),this.load(t)},store_set:function(e,t,a,r){a=a||meta.storeTypesEnum.Forever,r=r||720;var n=this.toString(t),o=new Date,i={value:n,type:a,expiry:r,created:o.getTime(),lastread:o.getTime()},s=a===meta.storeTypesEnum.Session?window.sessionStorage:window.localStorage,m=JSON.stringify(i);s.setItem(e,m)},store_get:function(e){var t=window.localStorage,a=t.getItem(e);if(a||(a=(t=window.sessionStorage).getItem(e)),!a)return null;try{var r=JSON.parse(a);if(r.type==meta.storeTypesEnum.Session)return r.value;if(r.type==meta.storeTypesEnum.Forever)return r.value;if(r.type==meta.storeTypesEnum.OneTimeRead){var n=r.value;return t.setItem(e,null),n}if(r.type==meta.storeTypesEnum.ExpiryNoExtend){if((o=new Date).setTime(r.created),o.setHours(o.getHours()+r.expiry),(i=new Date).getTime()<=o.getTime())return r.value}else if(r.type==meta.storeTypesEnum.ExpiryExtend){var o,i;if((o=new Date).setTime(r.lastread),o.setHours(o.getHours()+r.expiry),(i=new Date).getTime()<=o.getTime())return r.lastread=i.getTime(),t.setItem(e,JSON.stringify(r)),r.value}}catch(e){}return null},filter:function(e,t,a,r){for(var n=[],o=0;o<e.length;o++)if(e[o][t]==a){if(r)return e[o];n.push(e[o])}return n},getUrlParam:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},getElemAttr:function(e,t){try{return e.getAttribute(t)}catch(e){}return""},unique:function(){return(new Date).getTime()},copy:function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Node)return e.outerHTML?this.parseHTML(e.outerHTML):e.cloneNode(!0);if(e instanceof NodeList){for(var t,a=document.createDocumentFragment(),r=e.childNodes?e.childNodes.length:e.length,n=0;n<r;n++)if(t=null,e.childNodes&&e.childNodes.length&&e.childNodes[n]?t=e.childNodes[n]:e.length&&e[n]&&(t=e[n]),t){var o=this.copy(t);a.appendChild(o)}return a}if(e.constructor===Array||e.constructor===Object)try{return JSON.parse(JSON.stringify(e))}catch(e){console.log("Error: meta.copy: unable to parse source as json")}return e.constructor===Date?(target=new Date,target.setTime(e.getTime()),target):new e.constructor(e)},toString:function(e){if(null===e||"object"!=typeof e)return e;if(e.constructor===Array||e.constructor===Object)try{return JSON.stringify(e)}catch(e){console.log("Error: meta.toString: unable to parse source as json")}if(e instanceof Node&&e.outerHTML)return e.outerHTML;if(e instanceof NodeList){var t="";if(docfrag&&docfrag.childNodes&&docfrag.childNodes.length&&docfrag.childNodes.length>0)for(var a=0;a<docfrag.childNodes.length;a++)docfrag.childNodes[a]&&(docfrag.childNodes[a].outerHTML?t+=docfrag.childNodes[a].outerHTML:docfrag.childNodes[a].textContent&&(t+=docfrag.childNodes[a].textContent));return t}if(e.constructor===Date)return e.toString();console.log("Error: meta.toString: unable to parse source")},versionCheck:function(e,t){if(e===t)return!0;semVerArr=e.toString().split("."),requiredSemVerArr=t.toString().split(".");for(var a=0;a<requiredSemVerArr.length;a++){if(semVerArr.length==a)return!1;if(parseInt(semVerArr[a])>parseInt(requiredSemVerArr[a]))return!0;if(parseInt(semVerArr[a])<parseInt(requiredSemVerArr[a]))return!1}return!0},extend:function(e,t){for(var a in t){var r=t[a];if(null===r||"object"!=typeof r||r instanceof Node)e[a]=r;else if(t.constructor===Date){var n=new Date;n.setTime(r.getTime()),e[a]=n}else e[a]=Array.isArray(t)?[]:{},e[a]=this.extend(e[a],r)}return e},ajax:function(e){$.ajax(e)},ready:function(e){var t=document.readyState;"interactive"===t||"complete"===t?e():setTimeout(function(){meta.ready(e)},100)},select:function(e){return document.getElementById(e)},selectAll:function(e,t){return(t=t||document).querySelectorAll(e)},parseHTML:function(){var e=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,t=/<([\w:]+)/,a=/<|&#?\w+;/,r={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};return function(n,o){if(!n)return null;var i,s,m,l,u=(o=o||document).createDocumentFragment();if(a.test(n)){for(i=u.appendChild(o.createElement("div")),s=(t.exec(n)||["",""])[1].toLowerCase(),m=r[s]||r._default,i.innerHTML=m[1]+n.replace(e,"<$1></$2>")+m[2],l=m[0];l--;)i=i.lastChild;for(u.removeChild(u.firstChild);i.firstChild;)u.appendChild(i.firstChild)}else u.appendChild(o.createTextNode(n));return u}}()};